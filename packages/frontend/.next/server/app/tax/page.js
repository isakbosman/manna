(()=>{var e={};e.id=599,e.ids=[599],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},68838:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>d,routeModule:()=>u,tree:()=>o}),t(10209),t(32487),t(87824);var a=t(93282),r=t(5736),n=t(93906),i=t.n(n),l=t(36880),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);t.d(s,c);let o=["",{children:["tax",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,10209)),"/Users/isak/dev/accounts/packages/frontend/src/app/tax/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,32487)),"/Users/isak/dev/accounts/packages/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,87824,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/isak/dev/accounts/packages/frontend/src/app/tax/page.tsx"],m="/tax/page",x={require:t,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/tax/page",pathname:"/tax",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},9471:(e,s,t)=>{Promise.resolve().then(t.bind(t,75183))},61054:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(24583).Z)("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]])},42190:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(24583).Z)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},10138:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(24583).Z)("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]])},75183:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>se});var a=t(73227),r=t(23677),n=t.n(r),i=t(25942),l=t(97464),c=t(93770),o=t(71692),d=t(20426),m=t(24583);let x=(0,m.Z)("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);var u=t(35010),h=t(40087),p=t(79580),g=t(11250),j=t(24988),y=t(44467),f=t(38674),b=t(42114),v=t(93126),N=t(10200),w=t(61054),_=t(12198),C=t(44721);let S=(0,m.Z)("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]),k=(0,m.Z)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);var z=t(54686),P=t(73956),Z=t(83414),T=t(4697),M=t(53074),R=t(45604),D=t(66016),E=t(52764),q=t(56748),U=t(37388),A=t(47271),L=t(45579),F=t(98369),$=["PageUp","PageDown"],I=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],B={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},O="Slider",[V,K,H]=(0,F.B)(O),[W,Y]=(0,D.b)(O,[H]),[G,X]=W(O),Q=r.forwardRef((e,s)=>{let{name:t,min:n=0,max:i=100,step:l=1,orientation:c="horizontal",disabled:o=!1,minStepsBetweenThumbs:d=0,defaultValue:m=[n],value:x,onValueChange:u=()=>{},onValueCommit:h=()=>{},inverted:p=!1,form:g,...j}=e,y=r.useRef(new Set),f=r.useRef(0),b="horizontal"===c?es:et,[v=[],N]=(0,E.T)({prop:x,defaultProp:m,onChange:e=>{let s=[...y.current];s[f.current]?.focus(),u(e)}}),w=r.useRef(v);function _(e,s,{commit:t}={commit:!1}){let a=(String(l).split(".")[1]||"").length,r=function(e,s){let t=Math.pow(10,s);return Math.round(e*t)/t}(Math.round((e-n)/l)*l+n,a),c=(0,T.u)(r,[n,i]);N((e=[])=>{var a,r;let n=function(e=[],s,t){let a=[...e];return a[t]=s,a.sort((e,s)=>e-s)}(e,c,s);if(a=n,!(!((r=d*l)>0)||Math.min(...a.slice(0,-1).map((e,s)=>a[s+1]-e))>=r))return e;{f.current=n.indexOf(c);let s=String(n)!==String(e);return s&&t&&h(n),s?n:e}})}return(0,a.jsx)(G,{scope:e.__scopeSlider,name:t,disabled:o,min:n,max:i,valueIndexToChangeRef:f,thumbs:y.current,values:v,orientation:c,form:g,children:(0,a.jsx)(V.Provider,{scope:e.__scopeSlider,children:(0,a.jsx)(V.Slot,{scope:e.__scopeSlider,children:(0,a.jsx)(b,{"aria-disabled":o,"data-disabled":o?"":void 0,...j,ref:s,onPointerDown:(0,M.Mj)(j.onPointerDown,()=>{o||(w.current=v)}),min:n,max:i,inverted:p,onSlideStart:o?void 0:function(e){let s=function(e,s){if(1===e.length)return 0;let t=e.map(e=>Math.abs(e-s));return t.indexOf(Math.min(...t))}(v,e);_(e,s)},onSlideMove:o?void 0:function(e){_(e,f.current)},onSlideEnd:o?void 0:function(){let e=w.current[f.current];v[f.current]!==e&&h(v)},onHomeKeyDown:()=>!o&&_(n,0,{commit:!0}),onEndKeyDown:()=>!o&&_(i,v.length-1,{commit:!0}),onStepKeyDown:({event:e,direction:s})=>{if(!o){let t=$.includes(e.key)||e.shiftKey&&I.includes(e.key),a=f.current;_(v[a]+l*(t?10:1)*s,a,{commit:!0})}}})})})})});Q.displayName=O;var[J,ee]=W(O,{startEdge:"left",endEdge:"right",size:"width",direction:1}),es=r.forwardRef((e,s)=>{let{min:t,max:n,dir:i,inverted:l,onSlideStart:c,onSlideMove:o,onSlideEnd:d,onStepKeyDown:m,...x}=e,[u,h]=r.useState(null),p=(0,R.e)(s,e=>h(e)),g=r.useRef(void 0),j=(0,q.gm)(i),y="ltr"===j,f=y&&!l||!y&&l;function b(e){let s=g.current||u.getBoundingClientRect(),a=eu([0,s.width],f?[t,n]:[n,t]);return g.current=s,a(e-s.left)}return(0,a.jsx)(J,{scope:e.__scopeSlider,startEdge:f?"left":"right",endEdge:f?"right":"left",direction:f?1:-1,size:"width",children:(0,a.jsx)(ea,{dir:j,"data-orientation":"horizontal",...x,ref:p,style:{...x.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:e=>{let s=b(e.clientX);c?.(s)},onSlideMove:e=>{let s=b(e.clientX);o?.(s)},onSlideEnd:()=>{g.current=void 0,d?.()},onStepKeyDown:e=>{let s=B[f?"from-left":"from-right"].includes(e.key);m?.({event:e,direction:s?-1:1})}})})}),et=r.forwardRef((e,s)=>{let{min:t,max:n,inverted:i,onSlideStart:l,onSlideMove:c,onSlideEnd:o,onStepKeyDown:d,...m}=e,x=r.useRef(null),u=(0,R.e)(s,x),h=r.useRef(void 0),p=!i;function g(e){let s=h.current||x.current.getBoundingClientRect(),a=eu([0,s.height],p?[n,t]:[t,n]);return h.current=s,a(e-s.top)}return(0,a.jsx)(J,{scope:e.__scopeSlider,startEdge:p?"bottom":"top",endEdge:p?"top":"bottom",size:"height",direction:p?1:-1,children:(0,a.jsx)(ea,{"data-orientation":"vertical",...m,ref:u,style:{...m.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:e=>{let s=g(e.clientY);l?.(s)},onSlideMove:e=>{let s=g(e.clientY);c?.(s)},onSlideEnd:()=>{h.current=void 0,o?.()},onStepKeyDown:e=>{let s=B[p?"from-bottom":"from-top"].includes(e.key);d?.({event:e,direction:s?-1:1})}})})}),ea=r.forwardRef((e,s)=>{let{__scopeSlider:t,onSlideStart:r,onSlideMove:n,onSlideEnd:i,onHomeKeyDown:l,onEndKeyDown:c,onStepKeyDown:o,...d}=e,m=X(O,t);return(0,a.jsx)(L.WV.span,{...d,ref:s,onKeyDown:(0,M.Mj)(e.onKeyDown,e=>{"Home"===e.key?(l(e),e.preventDefault()):"End"===e.key?(c(e),e.preventDefault()):$.concat(I).includes(e.key)&&(o(e),e.preventDefault())}),onPointerDown:(0,M.Mj)(e.onPointerDown,e=>{let s=e.target;s.setPointerCapture(e.pointerId),e.preventDefault(),m.thumbs.has(s)?s.focus():r(e)}),onPointerMove:(0,M.Mj)(e.onPointerMove,e=>{e.target.hasPointerCapture(e.pointerId)&&n(e)}),onPointerUp:(0,M.Mj)(e.onPointerUp,e=>{let s=e.target;s.hasPointerCapture(e.pointerId)&&(s.releasePointerCapture(e.pointerId),i(e))})})}),er="SliderTrack",en=r.forwardRef((e,s)=>{let{__scopeSlider:t,...r}=e,n=X(er,t);return(0,a.jsx)(L.WV.span,{"data-disabled":n.disabled?"":void 0,"data-orientation":n.orientation,...r,ref:s})});en.displayName=er;var ei="SliderRange",el=r.forwardRef((e,s)=>{let{__scopeSlider:t,...n}=e,i=X(ei,t),l=ee(ei,t),c=r.useRef(null),o=(0,R.e)(s,c),d=i.values.length,m=i.values.map(e=>ex(e,i.min,i.max));return(0,a.jsx)(L.WV.span,{"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,...n,ref:o,style:{...e.style,[l.startEdge]:(d>1?Math.min(...m):0)+"%",[l.endEdge]:100-Math.max(...m)+"%"}})});el.displayName=ei;var ec="SliderThumb",eo=r.forwardRef((e,s)=>{let t=K(e.__scopeSlider),[n,i]=r.useState(null),l=(0,R.e)(s,e=>i(e)),c=r.useMemo(()=>n?t().findIndex(e=>e.ref.current===n):-1,[t,n]);return(0,a.jsx)(ed,{...e,ref:l,index:c})}),ed=r.forwardRef((e,s)=>{let{__scopeSlider:t,index:n,name:i,...l}=e,c=X(ec,t),o=ee(ec,t),[d,m]=r.useState(null),x=(0,R.e)(s,e=>m(e)),u=!d||c.form||!!d.closest("form"),h=(0,A.t)(d),p=c.values[n],g=void 0===p?0:ex(p,c.min,c.max),j=function(e,s){return s>2?`Value ${e+1} of ${s}`:2===s?["Minimum","Maximum"][e]:void 0}(n,c.values.length),y=h?.[o.size],f=y?function(e,s,t){let a=e/2,r=eu([0,50],[0,a]);return(a-r(s)*t)*t}(y,g,o.direction):0;return r.useEffect(()=>{if(d)return c.thumbs.add(d),()=>{c.thumbs.delete(d)}},[d,c.thumbs]),(0,a.jsxs)("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[o.startEdge]:`calc(${g}% + ${f}px)`},children:[(0,a.jsx)(V.ItemSlot,{scope:e.__scopeSlider,children:(0,a.jsx)(L.WV.span,{role:"slider","aria-label":e["aria-label"]||j,"aria-valuemin":c.min,"aria-valuenow":p,"aria-valuemax":c.max,"aria-orientation":c.orientation,"data-orientation":c.orientation,"data-disabled":c.disabled?"":void 0,tabIndex:c.disabled?void 0:0,...l,ref:x,style:void 0===p?{display:"none"}:e.style,onFocus:(0,M.Mj)(e.onFocus,()=>{c.valueIndexToChangeRef.current=n})})}),u&&(0,a.jsx)(em,{name:i??(c.name?c.name+(c.values.length>1?"[]":""):void 0),form:c.form,value:p},n)]})});eo.displayName=ec;var em=r.forwardRef(({__scopeSlider:e,value:s,...t},n)=>{let i=r.useRef(null),l=(0,R.e)(i,n),c=(0,U.D)(s);return r.useEffect(()=>{let e=i.current;if(!e)return;let t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value").set;if(c!==s&&t){let a=new Event("input",{bubbles:!0});t.call(e,s),e.dispatchEvent(a)}},[c,s]),(0,a.jsx)(L.WV.input,{style:{display:"none"},...t,ref:l,defaultValue:s})});function ex(e,s,t){return(0,T.u)(100/(t-s)*(e-s),[0,100])}function eu(e,s){return t=>{if(e[0]===e[1]||s[0]===s[1])return s[0];let a=(s[1]-s[0])/(e[1]-e[0]);return s[0]+a*(t-e[0])}}em.displayName="RadioBubbleInput";var eh=t(18755);let ep=r.forwardRef(({className:e,...s},t)=>(0,a.jsxs)(Q,{ref:t,className:(0,eh.cn)("relative flex w-full touch-none select-none items-center",e),...s,children:[a.jsx(en,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-slate-100",children:a.jsx(el,{className:"absolute h-full bg-slate-900"})}),a.jsx(eo,{className:"block h-5 w-5 rounded-full border-2 border-slate-900 bg-white ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-950 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));ep.displayName=Q.displayName;var eg=t(65330),ej=t(51500),ey=t(47118);let ef={categorizeSingle:async(e,s)=>ey.hi.post(ey.Pn.tax.categorize,{transaction_id:e,...s}),categorizeBulk:async e=>ey.hi.post(ey.Pn.tax.bulkCategorize,e),getTaxSummary:async e=>ey.hi.get(ey.Pn.tax.summary,e),getTaxCategories:async()=>ey.hi.get(ey.Pn.tax.categories),getChartOfAccounts:async()=>ey.hi.get(ey.Pn.chartOfAccounts.list),downloadScheduleC:async(e,s="csv")=>ey.hi.download(`${ey.Pn.tax.summary}/schedule-c/${e}?format=${s}`,`schedule-c-${e}.${s}`)};var eb=t(39885);function ev({isOpen:e,onClose:s,transaction:t,onTransactionUpdated:r}){let c=(0,f.NL)(),[d,m]=n().useState(""),[h,p]=n().useState(100),[y,T]=n().useState(""),[M,R]=n().useState(""),[D,E]=n().useState(0),[q,U]=n().useState(""),[A,L]=n().useState({}),{data:F=[],isLoading:$}=(0,i.a)({queryKey:["tax-categories"],queryFn:ef.getTaxCategories}),I=n().useMemo(()=>q?F.filter(e=>e.name.toLowerCase().includes(q.toLowerCase())||e.schedule_c_line.toLowerCase().includes(q.toLowerCase())||e.description.toLowerCase().includes(q.toLowerCase())):F,[F,q]),B=n().useMemo(()=>F.find(e=>e.id===d),[F,d]),O=(0,b.D)({mutationFn:e=>ef.categorizeSingle(t.id,e),onSuccess:e=>{r({...t,tax_categorization:e}),c.invalidateQueries({queryKey:["transactions"]}),c.invalidateQueries({queryKey:["tax-summary"]}),s()},onError:e=>{L({submit:e.message||"Failed to categorize transaction"})}}),V=()=>{let e={};return d||(e.category="Please select a tax category"),B?.requires_receipt&&!M.trim()&&(e.receipt="Receipt is required for this category"),B?.is_vehicle_expense&&D<=0&&(e.mileage="Mileage is required for vehicle expenses"),y.trim()||(e.businessPurpose="Business purpose is required"),(h<1||h>100)&&(e.businessUse="Business use percentage must be between 1% and 100%"),L(e),0===Object.keys(e).length},K=async()=>{if(!V())return;let e={tax_category_id:d,business_use_percentage:h,business_purpose:y.trim()||void 0,receipt_url:M.trim()||void 0,mileage:B?.is_vehicle_expense?D:void 0};O.mutate(e)},H=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Math.abs(e)),W=()=>{if(!B)return 0;let e=Math.abs(t.amount);return e=h/100*e,B.is_meals_50_percent&&(e*=.5),e};return e?a.jsx(z.Vq,{open:e,onOpenChange:s,children:(0,a.jsxs)(z.cZ,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(z.fK,{children:[(0,a.jsxs)(z.$N,{className:"flex items-center gap-2",children:[a.jsx(x,{className:"h-5 w-5"}),"Tax Categorization"]}),a.jsx(z.Be,{children:"Categorize this transaction for tax purposes and business expense tracking."})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[A.submit&&(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700",children:[a.jsx(v.Z,{className:"h-5 w-5"}),a.jsx("span",{children:A.submit})]}),a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:t.description}),(0,a.jsxs)("div",{className:"flex items-center gap-3 mt-2 text-sm text-gray-600",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(l.Z,{className:"h-4 w-4"}),(0,eb.WU)(new Date(t.date),"MMM d, yyyy")]}),t.merchant_name&&(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(u.Z,{className:"h-4 w-4"}),t.merchant_name]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:(0,eh.cn)("text-lg font-bold",t.amount<0?"text-red-600":"text-green-600"),children:[t.amount<0?"-":"+",H(t.amount)]}),B&&(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Deductible: ",H(W())]})]})]})}),(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx(Z._,{htmlFor:"category-search",children:"Tax Category"}),a.jsx(P.I,{id:"category-search",placeholder:"Search tax categories...",value:q,onChange:e=>U(e.target.value),className:A.category?"border-red-500":""}),A.category&&a.jsx("p",{className:"text-sm text-red-600",children:A.category})]}),a.jsx(ej.x,{className:"h-48 border rounded-lg",children:a.jsx("div",{className:"p-2 space-y-1",children:$?a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-b-2 border-blue-600"})}):0===I.length?a.jsx("div",{className:"text-center py-8 text-gray-500",children:q?"No categories found":"No tax categories available"}):I.map(e=>(0,a.jsxs)("button",{onClick:()=>m(e.id),className:(0,eh.cn)("w-full flex items-start gap-3 p-3 rounded-lg border text-left transition-colors hover:bg-gray-50",d===e.id?"border-blue-500 bg-blue-50":"border-gray-200"),children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("p",{className:"font-medium text-gray-900",children:e.name}),(0,a.jsxs)(j.C,{variant:"outline",className:"text-xs",children:["Line ",e.schedule_c_line]}),e.is_meals_50_percent&&a.jsx(j.C,{variant:"secondary",className:"text-xs",children:"50% Deductible"}),e.requires_receipt&&a.jsx(N.Z,{className:"h-4 w-4 text-orange-500"}),e.is_vehicle_expense&&a.jsx(w.Z,{className:"h-4 w-4 text-blue-500"})]}),a.jsx("p",{className:"text-sm text-gray-600",children:e.description})]}),d===e.id&&a.jsx(_.Z,{className:"h-5 w-5 text-blue-600 flex-shrink-0"})]},e.id))})}),B&&(0,a.jsxs)("div",{className:"space-y-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,a.jsxs)("h4",{className:"font-medium text-blue-900 flex items-center gap-2",children:[a.jsx(C.Z,{className:"h-4 w-4"}),"Category Details: ",B.name]}),B.has_business_use_percentage&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(Z._,{className:"flex items-center gap-2",children:[a.jsx(S,{className:"h-4 w-4"}),"Business Use Percentage: ",h,"%"]}),a.jsx(ep,{value:[h],onValueChange:e=>p(e[0]),max:100,min:1,step:1,className:"w-full"}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-600",children:[a.jsx("span",{children:"1%"}),a.jsx("span",{children:"100%"})]}),A.businessUse&&a.jsx("p",{className:"text-sm text-red-600",children:A.businessUse})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(Z._,{htmlFor:"business-purpose",className:"flex items-center gap-2",children:[a.jsx(o.Z,{className:"h-4 w-4"}),"Business Purpose *"]}),a.jsx(P.I,{id:"business-purpose",placeholder:"Describe the business purpose of this expense...",value:y,onChange:e=>T(e.target.value),className:A.businessPurpose?"border-red-500":""}),A.businessPurpose&&a.jsx("p",{className:"text-sm text-red-600",children:A.businessPurpose})]}),B.requires_receipt&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(Z._,{htmlFor:"receipt-url",className:"flex items-center gap-2",children:[a.jsx(N.Z,{className:"h-4 w-4"}),"Receipt URL *",(0,a.jsxs)(eg.u,{children:[a.jsx(eg.aJ,{asChild:!0,children:a.jsx(C.Z,{className:"h-4 w-4 text-gray-400 cursor-help"})}),a.jsx(eg._v,{children:a.jsx("p",{children:"Upload your receipt to cloud storage and paste the link here"})})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(P.I,{id:"receipt-url",placeholder:"https://...",value:M,onChange:e=>R(e.target.value),className:(0,eh.cn)("flex-1",A.receipt?"border-red-500":"")}),M&&a.jsx(g.z,{type:"button",variant:"outline",size:"sm",onClick:()=>window.open(M,"_blank"),children:a.jsx(k,{className:"h-4 w-4"})})]}),A.receipt&&a.jsx("p",{className:"text-sm text-red-600",children:A.receipt})]}),B.is_vehicle_expense&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(Z._,{htmlFor:"mileage",className:"flex items-center gap-2",children:[a.jsx(w.Z,{className:"h-4 w-4"}),"Business Miles *"]}),a.jsx(P.I,{id:"mileage",type:"number",placeholder:"0",value:D||"",onChange:e=>E(parseInt(e.target.value)||0),min:"0",className:A.mileage?"border-red-500":""}),A.mileage&&a.jsx("p",{className:"text-sm text-red-600",children:A.mileage}),a.jsx("p",{className:"text-xs text-gray-600",children:"Standard mileage rate for business use is typically deductible"})]}),B.is_meals_50_percent&&(0,a.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-yellow-50 border border-yellow-200 rounded text-sm text-yellow-800",children:[a.jsx(C.Z,{className:"h-4 w-4"}),a.jsx("span",{children:"Business meals are generally 50% deductible. The calculation has been adjusted automatically."})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white border border-blue-200 rounded",children:[a.jsx("span",{className:"font-medium text-gray-900",children:"Estimated Deductible Amount:"}),a.jsx("span",{className:"text-lg font-bold text-green-600",children:H(W())})]})]})]}),(0,a.jsxs)(z.cN,{children:[a.jsx(g.z,{variant:"outline",onClick:s,children:"Cancel"}),a.jsx(g.z,{onClick:K,disabled:!d||O.isPending,children:O.isPending?"Categorizing...":"Apply Tax Category"})]})]})}):null}var eN=t(40401),ew=t(22057),e_=t(13377);function eC({isOpen:e,onClose:s,transactions:t,onTransactionsUpdated:r}){let l=(0,f.NL)(),[c,d]=n().useState(""),[m,u]=n().useState(100),[h,p]=n().useState(""),[y,T]=n().useState(""),[M,R]=n().useState(0),[D,E]=n().useState(""),[q,U]=n().useState("select"),[A,L]=n().useState(0),[F,$]=n().useState(0),[I,B]=n().useState([]),[O,V]=n().useState({}),{data:K=[],isLoading:H}=(0,i.a)({queryKey:["tax-categories"],queryFn:ef.getTaxCategories}),W=n().useMemo(()=>D?K.filter(e=>e.name.toLowerCase().includes(D.toLowerCase())||e.schedule_c_line.toLowerCase().includes(D.toLowerCase())||e.description.toLowerCase().includes(D.toLowerCase())):K,[K,D]),Y=n().useMemo(()=>K.find(e=>e.id===c),[K,c]),G=(0,b.D)({mutationFn:async e=>{U("processing"),L(0),$(0),B([]);let s=[];for(let t=0;t<e.transaction_ids.length;t+=10)s.push(e.transaction_ids.slice(t,t+10));let t=[],a=[];for(let r=0;r<s.length;r++)try{let a={...e,transaction_ids:s[r]},n=await ef.categorizeBulk(a);t.push(...n),$(e=>e+s[r].length),L((r+1)/s.length*100)}catch(e){a.push(`Batch ${r+1}: ${e.message}`)}return a.length>0&&B(a),t},onSuccess:e=>{r(t.map(s=>{let t=e.find(e=>e.transaction_id===s.id);return t?{...s,tax_categorization:t}:s})),l.invalidateQueries({queryKey:["transactions"]}),l.invalidateQueries({queryKey:["tax-summary"]}),U("complete")},onError:e=>{B([e.message||"Failed to categorize transactions"]),U("select")}}),X=()=>{let e={};return c||(e.category="Please select a tax category"),Y?.requires_receipt&&!y.trim()&&(e.receipt="Receipt is required for this category"),Y?.is_vehicle_expense&&M<=0&&(e.mileage="Mileage is required for vehicle expenses"),h.trim()||(e.businessPurpose="Business purpose is required"),(m<1||m>100)&&(e.businessUse="Business use percentage must be between 1% and 100%"),V(e),0===Object.keys(e).length},Q=async()=>{if(!X())return;let e={transaction_ids:t.map(e=>e.id),tax_category_id:c,business_use_percentage:m,business_purpose:h.trim()||void 0,receipt_url:y.trim()||void 0,mileage:Y?.is_vehicle_expense?M:void 0};G.mutate(e)},J=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Math.abs(e)),ee=t.reduce((e,s)=>e+Math.abs(s.amount),0),es=()=>{if(!Y)return 0;let e=ee;return e=m/100*e,Y.is_meals_50_percent&&(e*=.5),e},et=()=>{"processing"!==q&&s()};return e?a.jsx(z.Vq,{open:e,onOpenChange:et,children:(0,a.jsxs)(z.cZ,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(z.fK,{children:[(0,a.jsxs)(z.$N,{className:"flex items-center gap-2",children:[a.jsx(eN.Z,{className:"h-5 w-5"}),"Bulk Tax Categorization"]}),(0,a.jsxs)(z.Be,{children:["Apply the same tax category to ",t.length," selected transactions."]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[I.length>0&&a.jsx("div",{className:"space-y-2",children:I.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700",children:[a.jsx(v.Z,{className:"h-5 w-5"}),a.jsx("span",{children:e})]},s))}),"select"===q&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[a.jsx(x,{className:"h-5 w-5"}),t.length," Selected Transactions"]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-lg font-bold text-gray-900",children:["Total: ",J(ee)]}),Y&&(0,a.jsxs)("p",{className:"text-sm text-green-600",children:["Deductible: ",J(es())]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Sample transactions:"}),t.slice(0,3).map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between bg-white border rounded p-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium",children:e.description}),a.jsx("p",{className:"text-gray-600",children:(0,eb.WU)(new Date(e.date),"MMM d, yyyy")})]}),a.jsx("p",{className:"font-medium",children:J(e.amount)})]},e.id)),t.length>3&&(0,a.jsxs)("p",{className:"text-sm text-gray-500 text-center",children:["... and ",t.length-3," more transactions"]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx(Z._,{htmlFor:"category-search",children:"Tax Category"}),a.jsx(P.I,{id:"category-search",placeholder:"Search tax categories...",value:D,onChange:e=>E(e.target.value),className:O.category?"border-red-500":""}),O.category&&a.jsx("p",{className:"text-sm text-red-600",children:O.category})]}),a.jsx(ej.x,{className:"h-48 border rounded-lg",children:a.jsx("div",{className:"p-2 space-y-1",children:H?a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-b-2 border-blue-600"})}):0===W.length?a.jsx("div",{className:"text-center py-8 text-gray-500",children:D?"No categories found":"No tax categories available"}):W.map(e=>(0,a.jsxs)("button",{onClick:()=>d(e.id),className:(0,eh.cn)("w-full flex items-start gap-3 p-3 rounded-lg border text-left transition-colors hover:bg-gray-50",c===e.id?"border-blue-500 bg-blue-50":"border-gray-200"),children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("p",{className:"font-medium text-gray-900",children:e.name}),(0,a.jsxs)(j.C,{variant:"outline",className:"text-xs",children:["Line ",e.schedule_c_line]}),e.is_meals_50_percent&&a.jsx(j.C,{variant:"secondary",className:"text-xs",children:"50% Deductible"}),e.requires_receipt&&a.jsx(N.Z,{className:"h-4 w-4 text-orange-500"}),e.is_vehicle_expense&&a.jsx(w.Z,{className:"h-4 w-4 text-blue-500"})]}),a.jsx("p",{className:"text-sm text-gray-600",children:e.description})]}),c===e.id&&a.jsx(_.Z,{className:"h-5 w-5 text-blue-600 flex-shrink-0"})]},e.id))})}),Y&&(0,a.jsxs)("div",{className:"space-y-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,a.jsxs)("h4",{className:"font-medium text-blue-900 flex items-center gap-2",children:[a.jsx(C.Z,{className:"h-4 w-4"}),"Category Details: ",Y.name]}),Y.has_business_use_percentage&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(Z._,{className:"flex items-center gap-2",children:[a.jsx(S,{className:"h-4 w-4"}),"Business Use Percentage: ",m,"%"]}),a.jsx(ep,{value:[m],onValueChange:e=>u(e[0]),max:100,min:1,step:1,className:"w-full"}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-600",children:[a.jsx("span",{children:"1%"}),a.jsx("span",{children:"100%"})]}),O.businessUse&&a.jsx("p",{className:"text-sm text-red-600",children:O.businessUse})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(Z._,{htmlFor:"business-purpose",className:"flex items-center gap-2",children:[a.jsx(o.Z,{className:"h-4 w-4"}),"Business Purpose *"]}),a.jsx(P.I,{id:"business-purpose",placeholder:"Describe the business purpose of these expenses...",value:h,onChange:e=>p(e.target.value),className:O.businessPurpose?"border-red-500":""}),O.businessPurpose&&a.jsx("p",{className:"text-sm text-red-600",children:O.businessPurpose})]}),Y.requires_receipt&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(Z._,{htmlFor:"receipt-url",className:"flex items-center gap-2",children:[a.jsx(N.Z,{className:"h-4 w-4"}),"Receipt URL *",(0,a.jsxs)(eg.u,{children:[a.jsx(eg.aJ,{asChild:!0,children:a.jsx(C.Z,{className:"h-4 w-4 text-gray-400 cursor-help"})}),a.jsx(eg._v,{children:a.jsx("p",{children:"For bulk operations, provide a general receipt or folder link"})})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx(P.I,{id:"receipt-url",placeholder:"https://...",value:y,onChange:e=>T(e.target.value),className:(0,eh.cn)("flex-1",O.receipt?"border-red-500":"")}),y&&a.jsx(g.z,{type:"button",variant:"outline",size:"sm",onClick:()=>window.open(y,"_blank"),children:a.jsx(k,{className:"h-4 w-4"})})]}),O.receipt&&a.jsx("p",{className:"text-sm text-red-600",children:O.receipt})]}),Y.is_vehicle_expense&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(Z._,{htmlFor:"mileage",className:"flex items-center gap-2",children:[a.jsx(w.Z,{className:"h-4 w-4"}),"Total Business Miles *"]}),a.jsx(P.I,{id:"mileage",type:"number",placeholder:"0",value:M||"",onChange:e=>R(parseInt(e.target.value)||0),min:"0",className:O.mileage?"border-red-500":""}),O.mileage&&a.jsx("p",{className:"text-sm text-red-600",children:O.mileage}),a.jsx("p",{className:"text-xs text-gray-600",children:"Total business miles for all selected vehicle expenses"})]}),Y.is_meals_50_percent&&(0,a.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-yellow-50 border border-yellow-200 rounded text-sm text-yellow-800",children:[a.jsx(C.Z,{className:"h-4 w-4"}),a.jsx("span",{children:"Business meals are generally 50% deductible. The calculation has been adjusted automatically."})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white border border-blue-200 rounded",children:[a.jsx("span",{className:"font-medium text-gray-900",children:"Estimated Total Deductible Amount:"}),a.jsx("span",{className:"text-lg font-bold text-green-600",children:J(es())})]})]})]}),"processing"===q&&(0,a.jsxs)("div",{className:"space-y-4 text-center",children:[a.jsx("div",{className:"flex items-center justify-center",children:a.jsx(ew.Z,{className:"h-8 w-8 animate-spin"})}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Processing Transactions"}),(0,a.jsxs)("p",{className:"text-gray-600 mb-4",children:["Applying tax categorization to ",t.length," transactions..."]}),a.jsx(e_.E,{value:A,className:"w-full"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:[F," of ",t.length," transactions processed"]})]})]}),"complete"===q&&(0,a.jsxs)("div",{className:"space-y-4 text-center",children:[a.jsx("div",{className:"flex items-center justify-center",children:a.jsx(_.Z,{className:"h-16 w-16 text-green-600"})}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-green-900",children:"Categorization Complete"}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Successfully categorized ",F," transactions for tax purposes."]}),I.length>0&&(0,a.jsxs)("p",{className:"text-orange-600 text-sm",children:[I.length," batch(es) encountered errors. Some transactions may need manual review."]})]})]})]}),(0,a.jsxs)(z.cN,{children:["select"===q&&(0,a.jsxs)(a.Fragment,{children:[a.jsx(g.z,{variant:"outline",onClick:et,children:"Cancel"}),(0,a.jsxs)(g.z,{onClick:Q,disabled:!c||G.isPending,children:["Apply to ",t.length," Transactions"]})]}),"processing"===q&&a.jsx(g.z,{disabled:!0,children:"Processing..."}),"complete"===q&&a.jsx(g.z,{onClick:et,children:"Done"})]})]})}):null}var eS=t(60237),ek=t(80582),ez=t(7527),eP=t(63062);function eZ({className:e}){let s=new Date().getFullYear(),[t,r]=n().useState(s),[m,x]=n().useState(""),[u,y]=n().useState({csv:!1,pdf:!1}),{data:f,isLoading:b,error:v}=(0,i.a)({queryKey:["tax-summary",t],queryFn:()=>ef.getTaxSummary(t),enabled:!!t}),w=n().useMemo(()=>{let e=[];for(let t=0;t<5;t++)e.push(s-t);return e},[s]),C=n().useMemo(()=>f?.categories?m?f.categories.filter(e=>e.category_name.toLowerCase().includes(m.toLowerCase())||e.schedule_c_line.toLowerCase().includes(m.toLowerCase())):f.categories:[],[f?.categories,m]),S=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),k=e=>{switch(e){case"complete":return"text-green-600 bg-green-50 border-green-200";case"partial":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"missing":return"text-red-600 bg-red-50 border-red-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},z=e=>{switch(e){case"complete":return a.jsx(_.Z,{className:"h-4 w-4"});case"partial":return a.jsx(eS.Z,{className:"h-4 w-4"});default:return a.jsx(o.Z,{className:"h-4 w-4"})}},Z=async e=>{try{y(s=>({...s,[e]:!0})),await ef.downloadScheduleC(t,e)}catch(e){console.error("Export failed:",e)}finally{y(s=>({...s,[e]:!1}))}};return v?a.jsx(p.Zb,{className:(0,eh.cn)("p-6",e),children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx(eS.Z,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Error Loading Tax Summary"}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Unable to load tax summary for ",t,". Please try again later."]})]})}):(0,a.jsxs)("div",{className:(0,eh.cn)("space-y-6",e),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Tax Summary"}),(0,a.jsxs)(eP.Ph,{value:t.toString(),onValueChange:e=>r(parseInt(e)),children:[a.jsx("option",{value:"",children:"Select Year"}),w.map(e=>a.jsx("option",{value:e.toString(),children:e},e))]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(g.z,{variant:"outline",size:"sm",onClick:()=>Z("csv"),disabled:!f||u.csv,children:[u.csv?a.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-b-2 border-gray-600"}):a.jsx(c.Z,{className:"h-4 w-4"}),"Export CSV"]}),(0,a.jsxs)(g.z,{variant:"outline",size:"sm",onClick:()=>Z("pdf"),disabled:!f||u.pdf,children:[u.pdf?a.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-b-2 border-gray-600"}):a.jsx(c.Z,{className:"h-4 w-4"}),"Export PDF"]})]})]}),b?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsxs)(p.Zb,{className:"p-6 animate-pulse",children:[a.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),a.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]},s))}):f?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,a.jsxs)(p.Zb,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(ek.Z,{className:"h-5 w-5 text-green-600"}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Total Deductions"})]}),a.jsx("p",{className:"text-2xl font-bold text-green-600",children:S(f.total_deductions)})]}),(0,a.jsxs)(p.Zb,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(o.Z,{className:"h-5 w-5 text-blue-600"}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Categories"})]}),a.jsx("p",{className:"text-2xl font-bold text-blue-600",children:f.categories.length})]}),(0,a.jsxs)(p.Zb,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(N.Z,{className:"h-5 w-5 text-orange-600"}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Transactions"})]}),a.jsx("p",{className:"text-2xl font-bold text-orange-600",children:f.documentation_status.total_transactions})]}),(0,a.jsxs)(p.Zb,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(_.Z,{className:"h-5 w-5 text-purple-600"}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Documentation"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("p",{className:"text-2xl font-bold text-purple-600",children:[(()=>{if(!f?.documentation_status)return 0;let{total_transactions:e,with_receipts:s,complete_business_purpose:t}=f.documentation_status;return 0===e?100:Math.round(s/e*50+t/e*50)})(),"%"]}),(0,a.jsxs)(eg.u,{children:[a.jsx(eg.aJ,{asChild:!0,children:a.jsx(eS.Z,{className:"h-4 w-4 text-gray-400 cursor-help"})}),a.jsx(eg._v,{children:a.jsx("p",{children:"Percentage of transactions with complete receipts and business purpose"})})]})]})]})]}),(0,a.jsxs)(p.Zb,{className:"p-6",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[a.jsx(N.Z,{className:"h-5 w-5"}),"Documentation Status"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Receipt Documentation"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"With Receipts"}),a.jsx("span",{children:f.documentation_status.with_receipts})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Missing Receipts"}),a.jsx("span",{className:"text-red-600",children:f.documentation_status.missing_receipts})]}),a.jsx(e_.E,{value:f.documentation_status.with_receipts/f.documentation_status.total_transactions*100,className:"h-2"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Business Purpose"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Complete"}),a.jsx("span",{children:f.documentation_status.complete_business_purpose})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Missing"}),a.jsx("span",{className:"text-red-600",children:f.documentation_status.missing_business_purpose})]}),a.jsx(e_.E,{value:f.documentation_status.complete_business_purpose/f.documentation_status.total_transactions*100,className:"h-2"})]})]})]})]}),(0,a.jsxs)(p.Zb,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[a.jsx(d.Z,{className:"h-5 w-5"}),"Deductions by Category"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(h.Z,{className:"h-4 w-4 text-gray-400"}),a.jsx(P.I,{placeholder:"Filter categories...",value:m,onChange:e=>x(e.target.value),className:"w-48"})]})]}),a.jsx(ej.x,{className:"max-h-96",children:a.jsx("div",{className:"space-y-3",children:0===C.length?a.jsx("div",{className:"text-center py-8 text-gray-500",children:m?"No categories match your filter":"No categorized transactions found"}):C.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-1",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:e.category_name}),(0,a.jsxs)(j.C,{variant:"outline",className:"text-xs",children:["Line ",e.schedule_c_line]}),(0,a.jsxs)("div",{className:(0,eh.cn)("flex items-center gap-1 px-2 py-1 rounded text-xs border",k(e.documentation_status)),children:[z(e.documentation_status),a.jsx("span",{className:"capitalize",children:e.documentation_status})]})]}),a.jsx("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:(0,a.jsxs)("span",{children:[e.transaction_count," transactions"]})})]}),(0,a.jsxs)("div",{className:"text-right",children:[a.jsx("p",{className:"text-lg font-bold text-gray-900",children:S(e.total_amount)}),a.jsx("div",{className:"flex items-center gap-2 mt-1",children:(0,a.jsxs)(g.z,{variant:"ghost",size:"sm",className:"text-xs",children:[a.jsx(ez.Z,{className:"h-3 w-3 mr-1"}),"View Details"]})})]})]},e.tax_category_id))})})]}),(0,a.jsxs)(p.Zb,{className:"p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(g.z,{variant:"outline",className:"h-auto p-4 text-left",children:(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-medium",children:"Review Missing Receipts"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[f.documentation_status.missing_receipts," transactions need receipts"]})]})}),a.jsx(g.z,{variant:"outline",className:"h-auto p-4 text-left",children:(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-medium",children:"Complete Business Purpose"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[f.documentation_status.missing_business_purpose," transactions need descriptions"]})]})}),a.jsx(g.z,{variant:"outline",className:"h-auto p-4 text-left",children:(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-medium",children:"Generate Schedule C"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Export data for tax filing"})]})})]})]})]}):(0,a.jsxs)(p.Zb,{className:"p-12 text-center",children:[a.jsx(l.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Tax Data"}),(0,a.jsxs)("p",{className:"text-gray-600",children:["No tax categorization data found for ",t,". Start categorizing transactions to see your tax summary."]})]})]})}var eT=t(10138),eM=t(36910),eR=t(65327),eD=t(25749),eE=t(42190),eq=t(13835),eU=t(65248),eA=t(74431),eL=t(74871),eF="Switch",[e$,eI]=(0,D.b)(eF),[eB,eO]=e$(eF),eV=r.forwardRef((e,s)=>{let{__scopeSwitch:t,name:n,checked:i,defaultChecked:l,required:c,disabled:o,value:d="on",onCheckedChange:m,form:x,...u}=e,[h,p]=r.useState(null),g=(0,R.e)(s,e=>p(e)),j=r.useRef(!1),y=!h||x||!!h.closest("form"),[f,b]=(0,E.T)({prop:i,defaultProp:l??!1,onChange:m,caller:eF});return(0,a.jsxs)(eB,{scope:t,checked:f,disabled:o,children:[(0,a.jsx)(L.WV.button,{type:"button",role:"switch","aria-checked":f,"aria-required":c,"data-state":eY(f),"data-disabled":o?"":void 0,disabled:o,value:d,...u,ref:g,onClick:(0,M.Mj)(e.onClick,e=>{b(e=>!e),y&&(j.current=e.isPropagationStopped(),j.current||e.stopPropagation())})}),y&&(0,a.jsx)(eW,{control:h,bubbles:!j.current,name:n,value:d,checked:f,required:c,disabled:o,form:x,style:{transform:"translateX(-100%)"}})]})});eV.displayName=eF;var eK="SwitchThumb",eH=r.forwardRef((e,s)=>{let{__scopeSwitch:t,...r}=e,n=eO(eK,t);return(0,a.jsx)(L.WV.span,{"data-state":eY(n.checked),"data-disabled":n.disabled?"":void 0,...r,ref:s})});eH.displayName=eK;var eW=r.forwardRef(({__scopeSwitch:e,control:s,checked:t,bubbles:n=!0,...i},l)=>{let c=r.useRef(null),o=(0,R.e)(c,l),d=(0,U.D)(t),m=(0,A.t)(s);return r.useEffect(()=>{let e=c.current;if(!e)return;let s=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(d!==t&&s){let a=new Event("click",{bubbles:n});s.call(e,t),e.dispatchEvent(a)}},[d,t,n]),(0,a.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:t,...i,tabIndex:-1,ref:o,style:{...i.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function eY(e){return e?"checked":"unchecked"}eW.displayName="SwitchBubbleInput";let eG=r.forwardRef(({className:e,...s},t)=>a.jsx(eV,{className:(0,eh.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-950 focus-visible:ring-offset-2 focus-visible:ring-offset-white disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-slate-900 data-[state=unchecked]:bg-slate-200",e),...s,ref:t,children:a.jsx(eH,{className:(0,eh.cn)("pointer-events-none block h-5 w-5 rounded-full bg-white shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));function eX({className:e}){(0,f.NL)();let[s,t]=n().useState(""),[r,l]=n().useState(""),[c,o]=n().useState(!1),[m,x]=n().useState(new Set),[y,b]=n().useState(!1),[v,N]=n().useState(null),[w,_]=n().useState({name:"",account_type:"asset",parent_id:"",is_active:!0}),[C,S]=n().useState({}),{data:k=[],isLoading:T,error:M}=(0,i.a)({queryKey:["chart-of-accounts"],queryFn:ef.getChartOfAccounts}),R=n().useMemo(()=>{let e=(s,t=null,a=0)=>s.filter(e=>e.parent_id===t).map(t=>({...t,level:a,children:e(s,t.id,a+1)})).sort((e,s)=>e.name.localeCompare(s.name));return e(k)},[k]),D=n().useMemo(()=>{let e=t=>{let a=!s||t.name.toLowerCase().includes(s.toLowerCase())||t.account_type.toLowerCase().includes(s.toLowerCase()),n=!r||t.account_type===r,i=c||t.is_active,l=t.children.map(s=>e(s)).filter(Boolean);return a&&n&&i||l.length>0?{...t,children:l}:null};return R.map(s=>e(s)).filter(Boolean)},[R,s,r,c]),E={asset:a.jsx(eT.Z,{className:"h-4 w-4 text-green-600"}),liability:a.jsx(eM.Z,{className:"h-4 w-4 text-red-600"}),equity:a.jsx(u.Z,{className:"h-4 w-4 text-blue-600"}),income:a.jsx(d.Z,{className:"h-4 w-4 text-emerald-600"}),expense:a.jsx(ek.Z,{className:"h-4 w-4 text-orange-600"})},q={asset:"text-green-600 bg-green-50 border-green-200",liability:"text-red-600 bg-red-50 border-red-200",equity:"text-blue-600 bg-blue-50 border-blue-200",income:"text-emerald-600 bg-emerald-50 border-emerald-200",expense:"text-orange-600 bg-orange-50 border-orange-200"},U=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e),A=e=>{x(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},L=e=>{_({name:e.name,account_type:e.account_type,parent_id:e.parent_id||"",is_active:e.is_active}),S({}),N(e),b(!0)},F=e=>{let s=e.children.length>0,t=m.has(e.id),r=24*e.level;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:(0,eh.cn)("flex items-center gap-2 p-3 border-b border-gray-100 hover:bg-gray-50 transition-colors",!e.is_active&&"opacity-50"),style:{paddingLeft:`${r+12}px`},children:[s?a.jsx("button",{onClick:()=>A(e.id),className:"p-1 hover:bg-gray-200 rounded",children:t?a.jsx(eR.Z,{className:"h-4 w-4"}):a.jsx(eD.Z,{className:"h-4 w-4"})}):a.jsx("div",{className:"w-6"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[E[e.account_type],a.jsx("span",{className:(0,eh.cn)("font-medium",!e.is_active&&"text-gray-500"),children:e.name}),!e.is_active&&a.jsx(eE.Z,{className:"h-4 w-4 text-gray-400"})]}),a.jsx(j.C,{variant:"outline",className:(0,eh.cn)("text-xs capitalize",q[e.account_type]),children:e.account_type}),(0,a.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[a.jsx("span",{className:(0,eh.cn)("font-medium",e.balance>=0?"text-green-600":"text-red-600"),children:U(e.balance)}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(g.z,{variant:"ghost",size:"sm",onClick:()=>L(e),className:"h-8 w-8 p-0",children:a.jsx(eq.Z,{className:"h-3 w-3"})}),a.jsx(g.z,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:a.jsx(eU.Z,{className:"h-3 w-3"})})]})]})]}),s&&t&&a.jsx("div",{children:e.children.map(e=>F(e))})]},e.id)},$=n().useMemo(()=>{let e={asset:0,liability:0,equity:0,income:0,expense:0};return k.forEach(s=>{s.is_active&&(e[s.account_type]+=s.balance)}),e},[k]);return M?a.jsx(p.Zb,{className:(0,eh.cn)("p-6",e),children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx(u.Z,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Error Loading Chart of Accounts"}),a.jsx("p",{className:"text-gray-600",children:"Unable to load chart of accounts. Please try again later."})]})}):(0,a.jsxs)("div",{className:(0,eh.cn)("space-y-6",e),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Chart of Accounts"}),(0,a.jsxs)(g.z,{onClick:()=>{_({name:"",account_type:"asset",parent_id:"",is_active:!0}),S({}),N(null),b(!0)},children:[a.jsx(eA.Z,{className:"h-4 w-4 mr-2"}),"Add Account"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:Object.entries($).map(([e,s])=>(0,a.jsxs)(p.Zb,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[E[e],a.jsx("h3",{className:"font-medium text-gray-700 capitalize",children:e})]}),a.jsx("p",{className:(0,eh.cn)("text-lg font-bold",s>=0?"text-green-600":"text-red-600"),children:U(s)})]},e))}),a.jsx(p.Zb,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(eL.Z,{className:"h-4 w-4 text-gray-400"}),a.jsx(P.I,{placeholder:"Search accounts...",value:s,onChange:e=>t(e.target.value),className:"w-64"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(h.Z,{className:"h-4 w-4 text-gray-400"}),(0,a.jsxs)("select",{value:r,onChange:e=>l(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm",children:[a.jsx("option",{value:"",children:"All Types"}),a.jsx("option",{value:"asset",children:"Assets"}),a.jsx("option",{value:"liability",children:"Liabilities"}),a.jsx("option",{value:"equity",children:"Equity"}),a.jsx("option",{value:"income",children:"Income"}),a.jsx("option",{value:"expense",children:"Expenses"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(eG,{checked:c,onCheckedChange:o}),a.jsx(Z._,{className:"text-sm",children:"Show inactive accounts"})]}),a.jsx(g.z,{variant:"outline",size:"sm",onClick:()=>{let e=new Set,s=t=>{t.forEach(t=>{t.children.length>0&&(e.add(t.id),s(t.children))})};s(D),x(e)},children:"Expand All"}),a.jsx(g.z,{variant:"outline",size:"sm",onClick:()=>x(new Set),children:"Collapse All"})]})}),(0,a.jsxs)(p.Zb,{children:[a.jsx("div",{className:"border-b border-gray-200 p-4",children:a.jsx("h3",{className:"font-semibold text-gray-900",children:"Accounts"})}),T?(0,a.jsxs)("div",{className:"p-8 text-center",children:[a.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-b-2 border-blue-600 mx-auto"}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Loading accounts..."})]}):0===D.length?a.jsx("div",{className:"p-8 text-center text-gray-500",children:s||r?"No accounts match your filters":"No accounts found"}):a.jsx(ej.x,{className:"max-h-96",children:a.jsx("div",{children:D.map(e=>F(e))})})]}),a.jsx(z.Vq,{open:y,onOpenChange:b,children:(0,a.jsxs)(z.cZ,{children:[(0,a.jsxs)(z.fK,{children:[a.jsx(z.$N,{children:v?"Edit Account":"Create New Account"}),a.jsx(z.Be,{children:v?"Update the account details below.":"Add a new account to your chart of accounts."})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx(Z._,{htmlFor:"account-name",children:"Account Name *"}),a.jsx(P.I,{id:"account-name",value:w.name,onChange:e=>_(s=>({...s,name:e.target.value})),placeholder:"Enter account name",className:C.name?"border-red-500":""}),C.name&&a.jsx("p",{className:"text-sm text-red-600 mt-1",children:C.name})]}),(0,a.jsxs)("div",{children:[a.jsx(Z._,{htmlFor:"account-type",children:"Account Type *"}),(0,a.jsxs)("select",{id:"account-type",value:w.account_type,onChange:e=>_(s=>({...s,account_type:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"asset",children:"Asset"}),a.jsx("option",{value:"liability",children:"Liability"}),a.jsx("option",{value:"equity",children:"Equity"}),a.jsx("option",{value:"income",children:"Income"}),a.jsx("option",{value:"expense",children:"Expense"})]})]}),(0,a.jsxs)("div",{children:[a.jsx(Z._,{htmlFor:"parent-account",children:"Parent Account (Optional)"}),(0,a.jsxs)("select",{id:"parent-account",value:w.parent_id,onChange:e=>_(s=>({...s,parent_id:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[a.jsx("option",{value:"",children:"No Parent (Top Level)"}),k.filter(e=>e.id!==v?.id).map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," (",e.account_type,")"]},e.id))]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(eG,{checked:w.is_active,onCheckedChange:e=>_(s=>({...s,is_active:e}))}),a.jsx(Z._,{children:"Active Account"})]})]}),(0,a.jsxs)(z.cN,{children:[a.jsx(g.z,{variant:"outline",onClick:()=>b(!1),children:"Cancel"}),a.jsx(g.z,{onClick:()=>{b(!1)},children:v?"Update Account":"Create Account"})]})]})})]})}eG.displayName=eV.displayName;var eQ=t(4175),eJ=t(25515),e0=t(5569),e1=t(40103),e2=t(88043),e4=t(90539),e5=t(87090),e6=t(10237);function e3({columns:e,data:s,searchPlaceholder:t="Filter...",onRowSelectionChange:n,enableRowSelection:i=!1,enableSorting:l=!0,enableFiltering:c=!0,enablePagination:o=!0,pageSize:d=10,className:m,emptyMessage:x="No results.",loading:u=!1}){let[h,p]=r.useState([]),[j,y]=r.useState([]),[f,b]=r.useState({}),[v,N]=r.useState({}),[w,_]=r.useState(""),C=r.useMemo(()=>i?[{id:"select",header:({table:e})=>a.jsx(e6.X,{checked:e.getIsAllPageRowsSelected(),onChange:s=>e.toggleAllPageRowsSelected(s.target.checked),"aria-label":"Select all"}),cell:({row:e})=>a.jsx(e6.X,{checked:e.getIsSelected(),onChange:s=>e.toggleSelected(s.target.checked),"aria-label":"Select row"}),enableSorting:!1,enableHiding:!1},...e]:e,[e,i]),S=(0,e2.b7)({data:s,columns:C,getCoreRowModel:(0,e4.sC)(),getPaginationRowModel:o?(0,e4.G_)():void 0,getSortedRowModel:l?(0,e4.tj)():void 0,getFilteredRowModel:c?(0,e4.vL)():void 0,onSortingChange:l?p:void 0,onColumnFiltersChange:c?y:void 0,onColumnVisibilityChange:b,onRowSelectionChange:N,onGlobalFilterChange:c?_:void 0,globalFilterFn:"includesString",state:{sorting:l?h:void 0,columnFilters:c?j:void 0,columnVisibility:f,rowSelection:i?v:void 0,globalFilter:c?w:void 0},initialState:{pagination:{pageSize:d}}});return r.useEffect(()=>{i&&n&&n(S.getSelectedRowModel().rows.map(e=>e.original))},[v,i,n,S]),(0,a.jsxs)("div",{className:(0,eh.cn)("space-y-4",m),children:[c&&a.jsx("div",{className:"flex items-center py-4",children:a.jsx("input",{placeholder:t,value:w,onChange:e=>_(e.target.value),className:"max-w-sm px-3 py-2 border border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})}),a.jsx("div",{className:"rounded-md border",children:(0,a.jsxs)("table",{className:"w-full",children:[a.jsx("thead",{children:S.getHeaderGroups().map(e=>a.jsx("tr",{className:"border-b bg-neutral-50",children:e.headers.map(e=>a.jsx("th",{className:"px-4 py-3 text-left font-medium text-neutral-900",children:e.isPlaceholder?null:(0,a.jsxs)("div",{className:(0,eh.cn)("flex items-center gap-2",l&&e.column.getCanSort()&&"cursor-pointer select-none"),onClick:l?e.column.getToggleSortingHandler():void 0,children:[(0,e2.ie)(e.column.columnDef.header,e.getContext()),l&&e.column.getCanSort()&&(0,a.jsxs)("div",{className:"flex flex-col",children:[a.jsx(e5.Z,{className:(0,eh.cn)("h-3 w-3","asc"===e.column.getIsSorted()?"text-primary-600":"text-neutral-400")}),a.jsx(eR.Z,{className:(0,eh.cn)("h-3 w-3 -mt-1","desc"===e.column.getIsSorted()?"text-primary-600":"text-neutral-400")})]})]})},e.id))},e.id))}),a.jsx("tbody",{children:u?a.jsx("tr",{children:a.jsx("td",{colSpan:e.length,className:"px-4 py-8 text-center",children:(0,a.jsxs)("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-b-2 border-primary-600"}),a.jsx("span",{className:"ml-2 text-neutral-600",children:"Loading..."})]})})}):S.getRowModel().rows?.length?S.getRowModel().rows.map(e=>a.jsx("tr",{className:(0,eh.cn)("border-b transition-colors hover:bg-neutral-50",e.getIsSelected()&&"bg-primary-50"),children:e.getVisibleCells().map(e=>a.jsx("td",{className:"px-4 py-3",children:(0,e2.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:e.length,className:"px-4 py-8 text-center text-neutral-600",children:x})})})]})}),o&&(0,a.jsxs)("div",{className:"flex items-center justify-between space-x-2 py-4",children:[a.jsx("div",{className:"flex-1 text-sm text-neutral-600",children:i&&(0,a.jsxs)("span",{children:[S.getFilteredSelectedRowModel().rows.length," of"," ",S.getFilteredRowModel().rows.length," row(s) selected."]})}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx(g.z,{variant:"outline",size:"sm",onClick:()=>S.previousPage(),disabled:!S.getCanPreviousPage(),children:"Previous"}),(0,a.jsxs)("div",{className:"flex items-center justify-center text-sm font-medium",children:["Page ",S.getState().pagination.pageIndex+1," of"," ",S.getPageCount()]}),a.jsx(g.z,{variant:"outline",size:"sm",onClick:()=>S.nextPage(),disabled:!S.getCanNextPage(),children:"Next"})]})]})]})}var e7=t(85882);function e8({transactions:e,accounts:s,categories:t,isLoading:r=!1,onTransactionSelect:i,onTransactionUpdate:c,onTransactionDelete:d,onRowSelectionChange:m,className:h}){let[p,y]=n().useState([]),[f,b]=n().useState(!1),[v,N]=n().useState(!1),[w,C]=n().useState(null),S=e=>{let s=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Math.abs(e));return e<0?`-${s}`:s},k=e=>e<0?"text-red-600":"text-green-600",z=e=>s.find(s=>s.id===e),P=async(e,s)=>{try{let t=await eQ.d.updateTransaction(e.id,{category:s});c(t)}catch(e){console.error("Failed to update transaction category:",e)}},Z=async e=>{try{let s=await e7.Y.categorizeTransaction(e.id);if(s.length>0){let t=s[0];t.confidence>.8&&await P(e,t.category_id)}}catch(e){console.error("Failed to ML categorize:",e)}},T=e=>{C(e),b(!0)},M=e=>{let s=e.tax_categorization;if(!s)return"none";let t=!!s.receipt_url,a=!!s.business_purpose;return t&&a?"complete":t||a?"partial":"minimal"},R=e=>{switch(e){case"complete":return"text-green-600 bg-green-50 border-green-200";case"partial":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"minimal":return"text-blue-600 bg-blue-50 border-blue-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},D=e=>{switch(e){case"complete":return a.jsx(_.Z,{className:"h-3 w-3"});case"partial":return a.jsx(eS.Z,{className:"h-3 w-3"});case"minimal":return a.jsx(x,{className:"h-3 w-3"});default:return a.jsx(o.Z,{className:"h-3 w-3"})}},E=[{accessorKey:"date",header:"Date",cell:({row:e})=>{let s=new Date(e.getValue("date"));return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(l.Z,{className:"h-4 w-4 text-gray-500"}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-medium",children:(0,eb.WU)(s,"MMM d")}),a.jsx("p",{className:"text-xs text-gray-500",children:(0,eb.WU)(s,"yyyy")})]})]})}},{accessorKey:"description",header:"Description",cell:({row:e})=>{let s=e.original;return(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsxs)("button",{onClick:()=>i(s),className:"text-left hover:text-blue-600 transition-colors",children:[a.jsx("p",{className:"font-medium truncate",children:s.description}),s.merchant_name&&a.jsx("p",{className:"text-sm text-gray-600 truncate",children:s.merchant_name})]}),a.jsx("div",{className:"flex items-center gap-1 mt-1",children:s.is_pending&&a.jsx(j.C,{variant:"outline",className:"text-xs text-yellow-600",children:"Pending"})})]})}},{accessorKey:"category",header:"Category",cell:({row:e})=>{let s=e.original;if(s.category){let e=t.find(e=>e.name===s.category);return a.jsx(j.C,{variant:e?.type==="income"?"default":e?.type==="expense"?"destructive":"secondary",className:"text-xs",children:s.category})}return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(eP.Ph,{value:"",onValueChange:e=>e&&P(s,e),children:[a.jsx(eP.i4,{className:"w-[180px]",children:a.jsx(eP.ki,{placeholder:"Uncategorized"})}),(0,a.jsxs)(eP.Bw,{children:[a.jsx(eP.Ql,{value:"",children:"Select category"}),t.map(e=>a.jsx(eP.Ql,{value:e.name,children:(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs",children:e.type}),e.name]})},e.name))]})]}),a.jsx(g.z,{variant:"ghost",size:"sm",onClick:()=>Z(s),className:"h-6 w-6 p-0",title:"AI Categorize",children:a.jsx(eJ.Z,{className:"h-3 w-3"})})]})}},{accessorKey:"tax_categorization",header:"Tax Status",cell:({row:e})=>{let s=e.original,t=M(s),r=s.tax_categorization;return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:(0,eh.cn)("flex items-center gap-1 px-2 py-1 rounded text-xs border",R(t)),children:[D(t),a.jsx("span",{className:"capitalize",children:"none"===t?"Not categorized":"minimal"===t?"Basic":"partial"===t?"Partial":"Complete"})]}),r&&a.jsx(eg.u,{content:`Business use: ${r.business_use_percentage}%`,children:(0,a.jsxs)(j.C,{variant:"outline",className:"text-xs",children:[r.business_use_percentage,"%"]})}),a.jsx(g.z,{variant:"ghost",size:"sm",onClick:()=>T(s),className:"h-6 w-6 p-0",title:"Tax Categorize",children:a.jsx(x,{className:"h-3 w-3"})})]})}},{accessorKey:"amount",header:"Amount",cell:({row:e})=>{let s=e.getValue("amount"),t=e.original.tax_categorization,r=0;return t&&s<0&&(r=t.business_use_percentage/100*Math.abs(s)),(0,a.jsxs)("div",{className:"text-right",children:[a.jsx("p",{className:(0,eh.cn)("font-medium",k(s)),children:S(s)}),r>0&&(0,a.jsxs)("p",{className:"text-xs text-green-600",children:["Deductible: ",S(r)]})]})}},{accessorKey:"account_id",header:"Account",cell:({row:e})=>{let s=z(e.getValue("account_id"));return s?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(u.Z,{className:"h-4 w-4 text-gray-500"}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:s.name}),a.jsx("p",{className:"text-xs text-gray-500",children:s.subtype})]})]}):null}},{id:"actions",header:"Actions",cell:({row:e})=>{let s=e.original,[t,r]=n().useState(!1);return(0,a.jsxs)("div",{className:"relative",children:[a.jsx(g.z,{variant:"ghost",size:"sm",onClick:()=>r(!t),className:"h-8 w-8 p-0",children:a.jsx(e0.Z,{className:"h-4 w-4"})}),t&&(0,a.jsxs)("div",{className:"absolute right-0 top-8 z-50 w-48 rounded-md border border-gray-200 bg-white py-1 shadow-lg",children:[(0,a.jsxs)("button",{onClick:()=>{i(s),r(!1)},className:"flex w-full items-center gap-2 px-3 py-2 text-sm hover:bg-gray-50",children:[a.jsx(ez.Z,{className:"h-4 w-4"}),"View Details"]}),(0,a.jsxs)("button",{onClick:()=>{T(s),r(!1)},className:"flex w-full items-center gap-2 px-3 py-2 text-sm hover:bg-gray-50",children:[a.jsx(x,{className:"h-4 w-4"}),"Tax Categorize"]}),(0,a.jsxs)("button",{onClick:()=>{i(s),r(!1)},className:"flex w-full items-center gap-2 px-3 py-2 text-sm hover:bg-gray-50",children:[a.jsx(eq.Z,{className:"h-4 w-4"}),"Edit"]}),(0,a.jsxs)("button",{onClick:()=>{Z(s),r(!1)},className:"flex w-full items-center gap-2 px-3 py-2 text-sm hover:bg-gray-50",disabled:!!s.category,children:[a.jsx(eJ.Z,{className:"h-4 w-4"}),"AI Categorize"]}),a.jsx("hr",{className:"my-1"}),(0,a.jsxs)("button",{onClick:()=>{window.confirm("Are you sure you want to delete this transaction?")&&d(s.id),r(!1)},className:"flex w-full items-center gap-2 px-3 py-2 text-sm text-red-600 hover:bg-red-50",children:[a.jsx(e1.Z,{className:"h-4 w-4"}),"Delete"]})]})]})}}];return(0,a.jsxs)("div",{className:h,children:[p.length>0&&a.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"text-sm font-medium text-blue-900",children:[p.length," transaction(s) selected"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(g.z,{variant:"outline",size:"sm",onClick:()=>{p.length>0&&N(!0)},children:[a.jsx(x,{className:"h-4 w-4 mr-1"}),"Bulk Tax Categorize"]}),a.jsx(g.z,{variant:"outline",size:"sm",onClick:()=>y([]),children:"Clear Selection"})]})]})}),a.jsx(e3,{columns:E,data:e,enableRowSelection:!0,enableSorting:!0,enableFiltering:!1,enablePagination:!0,pageSize:25,loading:r,onRowSelectionChange:e=>{y(e),m(e)},searchPlaceholder:"Search transactions...",emptyMessage:"No transactions found. Try adjusting your filters or sync your accounts."}),w&&a.jsx(ev,{isOpen:f,onClose:()=>{b(!1),C(null)},transaction:w,onTransactionUpdated:e=>{c(e),b(!1),C(null)}}),a.jsx(eC,{isOpen:v,onClose:()=>N(!1),transactions:p,onTransactionsUpdated:e=>{e.forEach(e=>{c(e)}),N(!1),y([])}})]})}var e9=t(87674);function se(){let[e,s]=n().useState("dashboard"),[t,r]=n().useState(new Date().getFullYear()),{data:m=[],isLoading:f}=(0,i.a)({queryKey:["transactions"],queryFn:e9.transactionsApi.getTransactions}),{data:b=[]}=(0,i.a)({queryKey:["accounts"],queryFn:e9.accountsApi.getAccounts}),{data:v=[]}=(0,i.a)({queryKey:["categories"],queryFn:e9.categoriesApi.getCategories}),{data:N}=(0,i.a)({queryKey:["tax-summary",t],queryFn:()=>ef.getTaxSummary(t)}),w=n().useMemo(()=>m.filter(e=>new Date(e.date).getFullYear()===t),[m,t]),_=n().useMemo(()=>{let e=w.length,s=w.filter(e=>e.tax_categorization).length,t=w.filter(e=>e.amount<0).reduce((e,s)=>e+Math.abs(s.amount),0),a=N?.total_deductions||0;return{totalTransactions:e,categorizedTransactions:s,categorizationPercentage:e>0?Math.round(s/e*100):0,totalExpenses:t,totalDeductions:a,potentialSavings:.25*a}},[w,N]),C=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e);return(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8 space-y-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Tax Management"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Categorize transactions and manage tax deductions for better financial reporting."})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx(l.Z,{className:"h-4 w-4 text-gray-400"}),a.jsx("select",{value:t,onChange:e=>r(parseInt(e.target.value)),className:"px-3 py-2 border border-gray-300 rounded-md text-sm",children:(()=>{let e=new Date().getFullYear(),s=[];for(let t=0;t<5;t++)s.push(e-t);return s})().map(e=>a.jsx("option",{value:e,children:e},e))})]}),(0,a.jsxs)(g.z,{variant:"outline",children:[a.jsx(c.Z,{className:"h-4 w-4 mr-2"}),"Export Tax Data"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,a.jsxs)(p.Zb,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(o.Z,{className:"h-5 w-5 text-blue-600"}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Transactions"})]}),a.jsx("p",{className:"text-2xl font-bold text-blue-600",children:_.totalTransactions}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[_.categorizedTransactions," categorized (",_.categorizationPercentage,"%)"]})]}),(0,a.jsxs)(p.Zb,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(d.Z,{className:"h-5 w-5 text-red-600"}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Total Expenses"})]}),a.jsx("p",{className:"text-2xl font-bold text-red-600",children:C(_.totalExpenses)}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Business expenses for ",t]})]}),(0,a.jsxs)(p.Zb,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(x,{className:"h-5 w-5 text-green-600"}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Tax Deductions"})]}),a.jsx("p",{className:"text-2xl font-bold text-green-600",children:C(_.totalDeductions)}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Approved business deductions"})]}),(0,a.jsxs)(p.Zb,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(u.Z,{className:"h-5 w-5 text-purple-600"}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Potential Savings"})]}),a.jsx("p",{className:"text-2xl font-bold text-purple-600",children:C(_.potentialSavings)}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Est. tax savings (25% rate)"})]})]}),(0,a.jsxs)(y.mQ,{value:e,onValueChange:s,children:[(0,a.jsxs)(y.dr,{className:"grid w-full grid-cols-4",children:[a.jsx(y.SP,{value:"dashboard",children:"Tax Dashboard"}),a.jsx(y.SP,{value:"transactions",children:"Categorize Transactions"}),a.jsx(y.SP,{value:"accounts",children:"Chart of Accounts"}),a.jsx(y.SP,{value:"reports",children:"Tax Reports"})]}),a.jsx(y.nU,{value:"dashboard",className:"space-y-6",children:a.jsx(eZ,{})}),a.jsx(y.nU,{value:"transactions",className:"space-y-6",children:(0,a.jsxs)(p.Zb,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Transaction Categorization"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Review and categorize transactions for tax purposes. Focus on business expenses for maximum deductions."})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(j.C,{variant:"outline",children:[_.categorizationPercentage,"% Categorized"]}),(0,a.jsxs)(g.z,{variant:"outline",size:"sm",children:[a.jsx(h.Z,{className:"h-4 w-4 mr-1"}),"Filter Uncategorized"]})]})]}),a.jsx(e8,{transactions:w,accounts:b,categories:v,isLoading:f,onTransactionSelect:e=>{console.log("Transaction selected:",e)},onTransactionUpdate:e=>{console.log("Transaction updated:",e)},onTransactionDelete:e=>{console.log("Transaction deleted:",e)},onRowSelectionChange:e=>{console.log("Selected transactions:",e)}})]})}),a.jsx(y.nU,{value:"accounts",className:"space-y-6",children:a.jsx(eX,{})}),a.jsx(y.nU,{value:"reports",className:"space-y-6",children:(0,a.jsxs)(p.Zb,{className:"p-8 text-center",children:[a.jsx(o.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Tax Reports"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Generate comprehensive tax reports including Schedule C, profit & loss statements, and deduction summaries."}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 max-w-2xl mx-auto",children:[a.jsx(g.z,{variant:"outline",className:"h-auto p-4",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("h4",{className:"font-medium",children:"Schedule C"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Export business income and expenses"})]})}),a.jsx(g.z,{variant:"outline",className:"h-auto p-4",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("h4",{className:"font-medium",children:"P&L Statement"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Profit and loss for tax year"})]})}),a.jsx(g.z,{variant:"outline",className:"h-auto p-4",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("h4",{className:"font-medium",children:"Deduction Summary"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Detailed breakdown by category"})]})})]})]})})]})]})}},51500:(e,s,t)=>{"use strict";t.d(s,{x:()=>i});var a=t(73227),r=t(23677),n=t(18755);let i=r.forwardRef(({className:e,children:s,viewportClassName:t,...r},i)=>a.jsx("div",{ref:i,className:(0,n.cn)("relative overflow-hidden",e),...r,children:a.jsx("div",{className:(0,n.cn)("h-full w-full overflow-auto scrollbar-thin scrollbar-thumb-neutral-300 scrollbar-track-transparent hover:scrollbar-thumb-neutral-400",t),children:s})}));i.displayName="ScrollArea"},65330:(e,s,t)=>{"use strict";t.d(s,{_v:()=>d,aJ:()=>o,pn:()=>l,u:()=>c});var a=t(73227),r=t(23677),n=t(78582),i=t(18755);let l=n.zt,c=n.fC,o=n.xz,d=r.forwardRef(({className:e,sideOffset:s=4,...t},r)=>a.jsx(n.VY,{ref:r,sideOffset:s,className:(0,i.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));d.displayName=n.VY.displayName},47118:(e,s,t)=>{"use strict";t.d(s,{Pn:()=>i,hi:()=>l});var a=t(85345);let r=process.env.NEXT_PUBLIC_API_URL||"http://localhost:8000",n=a.Z.create({baseURL:`${r}/api/v1`,timeout:3e4,headers:{"Content-Type":"application/json"},withCredentials:!0});n.interceptors.request.use(e=>e,e=>Promise.reject(e)),n.interceptors.response.use(e=>e,async e=>Promise.reject(e));let i={auth:{login:"/auth/login",register:"/auth/register",refresh:"/auth/refresh",logout:"/auth/logout",me:"/auth/me"},users:{list:"/users",get:e=>`/users/${e}`,update:e=>`/users/${e}`,delete:e=>`/users/${e}`,profile:"/users/profile"},accounts:{list:"/accounts",create:"/accounts",get:e=>`/accounts/${e}`,update:e=>`/accounts/${e}`,delete:e=>`/accounts/${e}`,sync:e=>`/accounts/${e}/sync`,balance:e=>`/accounts/${e}/balance`},transactions:{list:"/transactions",get:e=>`/transactions/${e}`,update:e=>`/transactions/${e}`,categorize:e=>`/transactions/${e}/categorize`,bulk:"/transactions/bulk",export:"/transactions/export",stats:"/transactions/stats"},categories:{list:"/categories",create:"/categories",get:e=>`/categories/${e}`,update:e=>`/categories/${e}`,delete:e=>`/categories/${e}`},plaid:{linkToken:"/plaid/link-token",exchangeToken:"/plaid/exchange-token",accounts:"/plaid/accounts",transactions:"/plaid/transactions",balance:"/plaid/balance",webhooks:"/plaid/webhooks"},ml:{categorize:"/ml/categorize",train:"/ml/train",predict:"/ml/predict",insights:"/ml/insights",anomalies:"/ml/anomalies"},reports:{pnl:"/reports/pnl",balanceSheet:"/reports/balance-sheet",cashFlow:"/reports/cash-flow",custom:"/reports/custom",export:"/reports/export"},settings:{get:"/settings",update:"/settings",preferences:"/settings/preferences",notifications:"/settings/notifications"},tax:{categories:"/tax/categories",categorize:"/tax/categorize",bulkCategorize:"/tax/bulk-categorize",summary:"/tax/summary",categorization:e=>`/tax/categorization/${e}`},chartOfAccounts:{list:"/chart-of-accounts",create:"/chart-of-accounts",get:e=>`/chart-of-accounts/${e}`,update:e=>`/chart-of-accounts/${e}`,delete:e=>`/chart-of-accounts/${e}`},health:"/health"},l={get:async(e,s)=>(await n.get(e,{params:s})).data,post:async(e,s,t)=>(await n.post(e,s,t)).data,put:async(e,s)=>(await n.put(e,s)).data,patch:async(e,s)=>(await n.patch(e,s)).data,delete:async e=>(await n.delete(e)).data,upload:async(e,s,t="file")=>{let a=new FormData;return a.append(t,s),(await n.post(e,a,{headers:{"Content-Type":"multipart/form-data"}})).data},download:async(e,s)=>{let t=new Blob([(await n.get(e,{responseType:"blob"})).data]),a=window.URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download=s||"download",document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(a)}};class c{constructor(e="ws://localhost:8000/ws"){this.url=e,this.ws=null,this.reconnectInterval=5e3,this.reconnectTimer=null,this.messageHandlers=new Map}connect(e){let s=e?`${this.url}?token=${e}`:this.url;this.ws=new WebSocket(s),this.ws.onopen=()=>{console.log("WebSocket connected"),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null)},this.ws.onmessage=e=>{try{let{type:s,data:t}=JSON.parse(e.data),a=this.messageHandlers.get(s);a&&a.forEach(e=>e(t))}catch(e){console.error("Failed to parse WebSocket message:",e)}},this.ws.onerror=e=>{console.error("WebSocket error:",e)},this.ws.onclose=()=>{console.log("WebSocket disconnected"),this.reconnect()}}reconnect(){this.reconnectTimer||(this.reconnectTimer=setTimeout(()=>{console.log("Attempting to reconnect WebSocket..."),this.connect()},this.reconnectInterval))}disconnect(){this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.ws&&(this.ws.close(),this.ws=null)}send(e,s){this.ws&&this.ws.readyState===WebSocket.OPEN?this.ws.send(JSON.stringify({type:e,data:s})):console.warn("WebSocket is not connected")}on(e,s){this.messageHandlers.has(e)||this.messageHandlers.set(e,new Set),this.messageHandlers.get(e).add(s)}off(e,s){let t=this.messageHandlers.get(e);t&&t.delete(s)}}new c},87674:(e,s,t)=>{"use strict";t.d(s,{hi:()=>l,iJ:()=>c});var a=t(85345),r=t(37379);let n=process.env.NEXT_PUBLIC_API_URL||"http://localhost:8000",i=a.Z.create({baseURL:n,timeout:3e4,headers:{"Content-Type":"application/json"}});i.interceptors.request.use(e=>e,e=>Promise.reject(e)),i.interceptors.response.use(e=>e,async e=>Promise.reject({message:e.response?.data?.message||e.message||"An error occurred",status:e.response?.status||500,code:e.response?.data?.code,details:e.response?.data?.details}));let l={get:async(e,s)=>(await i.get(e,s)).data,post:async(e,s,t)=>(await i.post(e,s,t)).data,put:async(e,s,t)=>(await i.put(e,s,t)).data,patch:async(e,s,t)=>(await i.patch(e,s,t)).data,delete:async(e,s)=>(await i.delete(e,s)).data,upload:async(e,s,t)=>{let a=new FormData;return a.append("file",s),(await i.post(e,a,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:e=>{t&&e.total&&t(Math.round(100*e.loaded/e.total))}})).data.data},download:async(e,s)=>{let t=new Blob([(await i.get(e,{responseType:"blob"})).data]),a=window.URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download=s||"download",document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(a)}},c={login:async e=>{let s=await l.post("/api/v1/auth/login",e),t=e.rememberMe?30:1,a=e.rememberMe?90:7;return s.access_token&&r.Z.set("access_token",s.access_token,{expires:t}),s.refresh_token&&r.Z.set("refresh_token",s.refresh_token,{expires:a}),s},logout:async()=>{try{await l.post("/api/v1/auth/logout")}catch(e){console.warn("Logout request failed:",e)}finally{r.Z.remove("access_token"),r.Z.remove("refresh_token")}},register:async e=>l.post("/api/v1/auth/register",e),forgotPassword:async e=>l.post("/api/v1/auth/forgot-password",{email:e}),resetPassword:async(e,s)=>l.post("/api/v1/auth/reset-password",{token:e,password:s}),verifyEmail:async e=>l.post("/api/v1/auth/verify-email",{token:e}),resendVerification:async e=>l.post("/api/v1/auth/resend-verification",{email:e}),getCurrentUser:async()=>l.get("/api/v1/users/me"),refreshToken:async()=>{let e=r.Z.get("refresh_token");if(!e)throw Error("No refresh token available");let s=await l.post("/api/v1/auth/refresh",{refresh_token:e});return s.access_token&&r.Z.set("access_token",s.access_token,{expires:1}),s.refresh_token&&r.Z.set("refresh_token",s.refresh_token,{expires:7}),s}}},85882:(e,s,t)=>{"use strict";t.d(s,{Y:()=>r});var a=t(87674);let r={getCategories:async()=>a.hi.get("/api/v1/categories"),getCategoryHierarchy:async()=>a.hi.get("/api/v1/categories?include_hierarchy=true"),getCategory:async e=>a.hi.get(`/api/v1/categories/${e}`),createCategory:async e=>a.hi.post("/api/v1/categories",e),updateCategory:async(e,s)=>a.hi.put(`/api/v1/categories/${e}`,s),deleteCategory:async e=>a.hi.delete(`/api/v1/categories/${e}`),bulkUpdateCategories:async e=>a.hi.patch("/api/v1/categories/bulk",{updates:e}),mergeCategories:async(e,s)=>a.hi.post("/api/v1/categories/merge",{source_id:e,target_id:s}),getCategoryStats:async e=>{let s=e?`?category_id=${e}`:"";return a.hi.get(`/api/v1/categories/stats${s}`)},exportCategories:async e=>a.hi.get(`/api/v1/categories/export?format=${e}`,{responseType:"blob"}),importCategories:async(e,s)=>{let t=new FormData;return t.append("file",e),s?.merge&&t.append("merge","true"),s?.overwrite&&t.append("overwrite","true"),a.hi.post("/api/v1/categories/import",t,{headers:{"Content-Type":"multipart/form-data"}})},getCategoryRules:async e=>a.hi.get(`/api/v1/categories/${e}/rules`),createCategoryRule:async(e,s)=>a.hi.post(`/api/v1/categories/${e}/rules`,s),updateCategoryRule:async(e,s,t)=>a.hi.put(`/api/v1/categories/${e}/rules/${s}`,t),deleteCategoryRule:async(e,s)=>a.hi.delete(`/api/v1/categories/${e}/rules/${s}`),testCategoryRules:async(e,s)=>a.hi.post("/api/v1/categories/test-rules",{rules:e,sample_size:s}),getCategorySpending:async e=>{let s=new URLSearchParams;return e&&Object.entries(e).forEach(([e,t])=>{null!=t&&s.append(e,t.toString())}),a.hi.get(`/api/v1/categories/spending?${s.toString()}`)},categorizeTransaction:async e=>a.hi.post("/api/v1/ml/categorize",{transaction_id:e}),provideFeedback:async(e,s,t)=>a.hi.post("/api/v1/ml/feedback",{transaction_id:e,category_id:s,is_correct:t}),bulkCategorize:async e=>a.hi.post("/api/v1/ml/bulk-categorize",{transaction_ids:e})}},4175:(e,s,t)=>{"use strict";t.d(s,{d:()=>r});var a=t(87674);let r={getTransactions:async e=>{let s=new URLSearchParams;e&&Object.entries(e).forEach(([e,t])=>{null!=t&&s.append(e,t.toString())});let t=await a.hi.get(`/api/v1/transactions?${s.toString()}`);return{transactions:t.items||[],total:t.total||0}},getTransaction:async e=>a.hi.get(`/api/v1/transactions/${e}`),updateTransaction:async(e,s)=>a.hi.put(`/api/v1/transactions/${e}`,s),deleteTransaction:async e=>a.hi.delete(`/api/v1/transactions/${e}`),bulkUpdateTransactions:async e=>a.hi.put("/api/v1/transactions/bulk",e),bulkDeleteTransactions:async e=>a.hi.post("/api/v1/transactions/bulk-delete",{transaction_ids:e}),markAsReviewed:async(e,s=!0)=>a.hi.put("/api/v1/transactions/bulk",{transaction_ids:e,updates:{notes:s?"reviewed":void 0}}),getTransactionStats:async e=>{let s=new URLSearchParams;return e&&Object.entries(e).forEach(([e,t])=>{null!=t&&s.append(e,t.toString())}),a.hi.get(`/api/v1/transactions/stats?${s.toString()}`)},syncTransactions:async e=>a.hi.post("/api/v1/plaid/sync-transactions",{account_ids:e?[e]:void 0}),categorizeTransactions:async e=>a.hi.post("/api/v1/transactions/categorize",{transaction_ids:e}),exportTransactions:async(e,s="csv")=>{let t=new URLSearchParams;return t.append("format",s),e&&Object.entries(e).forEach(([e,s])=>{null!=s&&("transaction_ids"===e&&Array.isArray(s)?s.forEach(e=>t.append("transaction_ids",e)):t.append(e,s.toString()))}),a.hi.download(`/api/v1/transactions/export?${t.toString()}`,`transactions.${s}`)},getTransactionSuggestions:async e=>a.hi.post("/api/v1/transactions/suggestions",{transaction_ids:e})}},10209:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(53189).createProxy)(String.raw`/Users/isak/dev/accounts/packages/frontend/src/app/tax/page.tsx#default`)}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[193,858,683,846,153,620,878,297,92,754],()=>t(68838));module.exports=a})();